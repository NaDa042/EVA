*This is the last version of the code*
